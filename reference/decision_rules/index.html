
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../planning/dynamic_programming/">
      
      
        <link rel="next" href="../utils/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Decision Rules - Behavioural Modelling</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#decision-rules" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Behavioural Modelling" class="md-header__button md-logo" aria-label="Behavioural Modelling" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Behavioural Modelling
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Decision Rules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/the-wise-lab/behavioural-modelling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    the-wise-lab/behavioural-modelling
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Behavioural Modelling" class="md-nav__button md-logo" aria-label="Behavioural Modelling" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Behavioural Modelling
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/the-wise-lab/behavioural-modelling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    the-wise-lab/behavioural-modelling
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning/beta_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beta Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../learning/rescorla_wagner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rescorla-Wagner
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Planning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Planning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../planning/dynamic_programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Decision Rules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Decision Rules
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;decision_rules
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" decision_rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_inverse_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_inverse_temperature
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_inverse_temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_inverse_temperature(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_inverse_temperature(inverse_temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;inverse_temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_stickiness
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_stickiness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(stickiness)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stickiness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(prev_choice)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;prev_choice
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_stickiness_inverse_temperature
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_stickiness_inverse_temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(inverse_temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;inverse_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(stickiness)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stickiness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(prev_choice)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;prev_choice
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_subtract_max" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_subtract_max
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_subtract_max">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_subtract_max(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_subtract_max(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/learning/beta_learning_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beta Model Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Planning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Planning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/planning/value_iteration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Making decision
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Making decision
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/decisions/simulating_choices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulating choices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/decisions/decision_rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decision rules
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;decision_rules
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" decision_rules">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_inverse_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_inverse_temperature
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_inverse_temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_inverse_temperature(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_inverse_temperature(inverse_temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;inverse_temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_stickiness
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_stickiness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(stickiness)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stickiness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness(prev_choice)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;prev_choice
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_stickiness_inverse_temperature
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_stickiness_inverse_temperature">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(inverse_temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;inverse_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(stickiness)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stickiness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(prev_choice)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;prev_choice
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_subtract_max" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_subtract_max
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_subtract_max">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_subtract_max(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.decision_rules.softmax_subtract_max(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="decision-rules">Decision Rules</h1>


<div class="doc doc-object doc-module">



<h2 id="behavioural_modelling.decision_rules" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">decision_rules</span>


</h2>

    <div class="doc doc-contents first">









<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.decision_rules.softmax" href="#behavioural_modelling.decision_rules.softmax">softmax</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function, with optional temperature parameter.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.decision_rules.softmax_inverse_temperature" href="#behavioural_modelling.decision_rules.softmax_inverse_temperature">softmax_inverse_temperature</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function, with optional inverse temperature parameter.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.decision_rules.softmax_stickiness" href="#behavioural_modelling.decision_rules.softmax_stickiness">softmax_stickiness</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function with choice stickiness, and optional temperature</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature" href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature">softmax_stickiness_inverse_temperature</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function with choice stickiness, and optional inverse temperature</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.decision_rules.softmax_subtract_max" href="#behavioural_modelling.decision_rules.softmax_subtract_max">softmax_subtract_max</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function, with optional temperature parameter.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.decision_rules.softmax" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax(temperature)">temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function, with optional temperature parameter.</p>
<p>In equation form, this is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{Q(a) / \tau}}{\sum_{b} e^{Q(b) / \tau}}
\]</div>
<p>Where <code>P(a)</code> is the probability of choosing action <code>a</code>,
<code>Q(a)</code> is the value of action <code>a</code>, and <code>au</code> is the
temperature parameter.</p>
<p>Note that the value of the temperature parameter will
depend on the range of the values of the Q function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, of shape
(n_trials, n_bandits)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax temperature, in range [0, inf].
Note that this is temperature rather than inverse temperature;
values are divided by this value. Higher values make choices less
deterministic. Defaults to 1.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ArrayLike</code></b> (              <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
)          –
          <div class="doc-md-description">
            <p>Choice probabilities, of shape (n_trials, n_bandits)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function, with optional temperature parameter.</span>

<span class="sd">    In equation form, this is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{Q(a) / \\tau}}{\\sum_{b} e^{Q(b) / \\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    Where `P(a)` is the probability of choosing action `a`,</span>
<span class="sd">    `Q(a)` is the value of action `a`, and `\tau` is the</span>
<span class="sd">    temperature parameter.</span>

<span class="sd">    Note that the value of the temperature parameter will</span>
<span class="sd">    depend on the range of the values of the Q function.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, of shape</span>
<span class="sd">            (n_trials, n_bandits)</span>
<span class="sd">        temperature (float, optional): Softmax temperature, in range [0, inf].</span>
<span class="sd">            Note that this is temperature rather than inverse temperature;</span>
<span class="sd">            values are divided by this value. Higher values make choices less</span>
<span class="sd">            deterministic. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ArrayLike: Choice probabilities, of shape (n_trials, n_bandits)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.decision_rules.softmax_inverse_temperature" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax_inverse_temperature</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax_inverse_temperature</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_inverse_temperature(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_inverse_temperature(inverse_temperature)">inverse_temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function, with optional inverse temperature parameter.</p>
<p>In equation form, this is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{\beta \cdot Q(a)}}{\sum_{b} e^{\beta \cdot Q(b)}}
\]</div>
<p>Where <code>P(a)</code> is the probability of choosing action <code>a</code>,
<code>Q(a)</code> is the value of action <code>a</code>, and <code>beta</code> is the
inverse temperature parameter.</p>
<p>Note that the value of the inverse temperature parameter will
depend on the range of the values of the Q function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_inverse_temperature(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, of shape
(n_trials, n_bandits)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_inverse_temperature(inverse_temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>inverse_temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax inverse temperature, in
range [0, inf]. Note that this is inverse temperature rather than
temperature; values are multiplied by this value. Higher values
make choices more deterministic. Defaults to 1.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax_inverse_temperature</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">inverse_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function, with optional inverse temperature parameter.</span>

<span class="sd">    In equation form, this is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{\\beta \\cdot Q(a)}}{\\sum_{b} e^{\\beta \\cdot Q(b)}}</span>
<span class="sd">    $$</span>

<span class="sd">    Where `P(a)` is the probability of choosing action `a`,</span>
<span class="sd">    `Q(a)` is the value of action `a`, and `beta` is the</span>
<span class="sd">    inverse temperature parameter.</span>

<span class="sd">    Note that the value of the inverse temperature parameter will</span>
<span class="sd">    depend on the range of the values of the Q function.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, of shape</span>
<span class="sd">            (n_trials, n_bandits)</span>
<span class="sd">        inverse_temperature (float, optional): Softmax inverse temperature, in</span>
<span class="sd">            range [0, inf]. Note that this is inverse temperature rather than</span>
<span class="sd">            temperature; values are multiplied by this value. Higher values</span>
<span class="sd">            make choices more deterministic. Defaults to 1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">inverse_temperature</span> <span class="o">*</span> <span class="n">value</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">inverse_temperature</span> <span class="o">*</span> <span class="n">value</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.decision_rules.softmax_stickiness" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax_stickiness</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax_stickiness</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness(temperature)">temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness(stickiness)">stickiness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness(prev_choice)">prev_choice</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function with choice stickiness, and optional temperature
parameter.</p>
<p>The standard softmax function is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{Q(a) / \tau}}{\sum_{b} e^{Q(b) / \tau}}
\]</div>
<p>With stickiness added:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{(Q(a) + \kappa \cdot same(a, a_{t-1}))/\tau}}
{\sum_{b} e^{(Q(b) + \kappa \cdot same(b, a_{t-1}))/\tau}}
\]</div>
<ul>
<li><span class="arithmatex">\(P(a)\)</span> is the probability of choosing action <span class="arithmatex">\(a\)</span></li>
<li><span class="arithmatex">\(Q(a)\)</span> is the value of action <span class="arithmatex">\(a\)</span></li>
<li><span class="arithmatex">\(\beta\)</span> is the temperature parameter</li>
<li><span class="arithmatex">\(\kappa\)</span> is the stickiness parameter</li>
<li><span class="arithmatex">\(same(a, a_{t-1})\)</span> is 1 if <span class="arithmatex">\(a\)</span> matches the previous choice, 0 otherwise</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, shape
<code>(n_trials, n_bandits)</code>. 
Note that this <strong>does not</strong>
account for trial-wise dependencies, so each trial is treated
independently (i.e., we use precomputed choices, therefore the 
precomputed choice on trial <code>t-1</code> can influence the choice on 
trial <code>t</code>, but this altered choice likelihood on trial <code>t</code> will not
affect any subsequent trials since we rely on the precomputed
choices provided).
This can be useful to apply the same stickiness to
all trials, but additional code will be required to account for
trial-wise dependencies (i.e., the choice on trial <code>t-1</code>)
influencing the choice on trial <code>t</code>, and this subsequently
influencing trials <code>t+1</code> etc.).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax temperature, in range [0, inf].
Note that this is temperature rather than inverse temperature;
values are divided by this value. Higher values
make choices less deterministic. Defaults to 1.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness(stickiness)" class="doc doc-heading doc-heading-parameter">              <b><code>stickiness</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>Weight given to previous choices, range
(-inf, inf). Positive values increase probability of repeating
choices. Defaults to 0.0</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness(prev_choice)" class="doc doc-heading doc-heading-parameter">              <b><code>prev_choice</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>One-hot encoded previous choices,
shape (n_trials, n_bandits). Defaults to None.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ArrayLike</code></b> (              <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
)          –
          <div class="doc-md-description">
            <p>Choice probabilities, shape (n_trials, n_bandits)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax_stickiness</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">stickiness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">prev_choice</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function with choice stickiness, and optional temperature</span>
<span class="sd">    parameter.</span>

<span class="sd">    The standard softmax function is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{Q(a) / \\tau}}{\\sum_{b} e^{Q(b) / \\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    With stickiness added:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{(Q(a) + \\kappa \\cdot same(a, a_{t-1}))/\\tau}}</span>
<span class="sd">    {\\sum_{b} e^{(Q(b) + \\kappa \\cdot same(b, a_{t-1}))/\\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    - $P(a)$ is the probability of choosing action $a$</span>
<span class="sd">    - $Q(a)$ is the value of action $a$</span>
<span class="sd">    - $\\beta$ is the temperature parameter</span>
<span class="sd">    - $\kappa$ is the stickiness parameter</span>
<span class="sd">    - $same(a, a_{t-1})$ is 1 if $a$ matches the previous choice, 0 otherwise</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, shape</span>
<span class="sd">            `(n_trials, n_bandits)`. </span>
<span class="sd">            Note that this **does not**</span>
<span class="sd">            account for trial-wise dependencies, so each trial is treated</span>
<span class="sd">            independently (i.e., we use precomputed choices, therefore the </span>
<span class="sd">            precomputed choice on trial `t-1` can influence the choice on </span>
<span class="sd">            trial `t`, but this altered choice likelihood on trial `t` will not</span>
<span class="sd">            affect any subsequent trials since we rely on the precomputed</span>
<span class="sd">            choices provided).</span>
<span class="sd">            This can be useful to apply the same stickiness to</span>
<span class="sd">            all trials, but additional code will be required to account for</span>
<span class="sd">            trial-wise dependencies (i.e., the choice on trial `t-1`)</span>
<span class="sd">            influencing the choice on trial `t`, and this subsequently</span>
<span class="sd">            influencing trials `t+1` etc.).</span>
<span class="sd">        temperature (float, optional): Softmax temperature, in range [0, inf].</span>
<span class="sd">            Note that this is temperature rather than inverse temperature;</span>
<span class="sd">            values are divided by this value. Higher values</span>
<span class="sd">            make choices less deterministic. Defaults to 1.0.</span>
<span class="sd">        stickiness (float, optional): Weight given to previous choices, range</span>
<span class="sd">            (-inf, inf). Positive values increase probability of repeating</span>
<span class="sd">            choices. Defaults to 0.0</span>
<span class="sd">        prev_choice (ArrayLike, optional): One-hot encoded previous choices,</span>
<span class="sd">            shape (n_trials, n_bandits). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ArrayLike: Choice probabilities, shape (n_trials, n_bandits)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sticky_value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">stickiness</span> <span class="o">*</span> <span class="n">prev_choice</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sticky_value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sticky_value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax_stickiness_inverse_temperature</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax_stickiness_inverse_temperature</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(inverse_temperature)">inverse_temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(stickiness)">stickiness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(prev_choice)">prev_choice</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function with choice stickiness, and optional inverse temperature
parameter.</p>
<p>The standard softmax function is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{\beta \cdot Q(a)}}{\sum_{b} e^{\beta \cdot Q(b)}}
\]</div>
<p>With stickiness added:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{(Q(a) + \kappa \cdot same(a, a_{t-1}))/\tau}}
{\sum_{b} e^{(Q(b) + \kappa \cdot same(b, a_{t-1}))/\tau}}
\]</div>
<ul>
<li><span class="arithmatex">\(P(a)\)</span> is the probability of choosing action <span class="arithmatex">\(a\)</span></li>
<li><span class="arithmatex">\(Q(a)\)</span> is the value of action <span class="arithmatex">\(a\)</span></li>
<li><span class="arithmatex">\(\beta\)</span> is the inverse temperature parameter</li>
<li><span class="arithmatex">\(\kappa\)</span> is the stickiness parameter</li>
<li><span class="arithmatex">\(same(a, a_{t-1})\)</span> is 1 if <span class="arithmatex">\(a\)</span> matches the previous choice, 0 otherwise</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, shape
<code>(n_trials, n_bandits)</code>. 
Note that this <strong>does not</strong>
account for trial-wise dependencies, so each trial is treated
independently (i.e., we use precomputed choices, therefore the 
precomputed choice on trial <code>t-1</code> can influence the choice on 
trial <code>t</code>, but this altered choice likelihood on trial <code>t</code> will not
affect any subsequent trials since we rely on the precomputed
choices provided).
This can be useful to apply the same stickiness to
all trials, but additional code will be required to account for
trial-wise dependencies (i.e., the choice on trial <code>t-1</code>)
influencing the choice on trial <code>t</code>, and this subsequently
influencing trials <code>t+1</code> etc.).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(inverse_temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>inverse_temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax inverse temperature,
range [0, inf]. Higher values make choices more deterministic.
Defaults to 1.0</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(stickiness)" class="doc doc-heading doc-heading-parameter">              <b><code>stickiness</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>Weight given to previous choices, range
(-inf, inf). Positive values increase probability of repeating
choices. Defaults to 0.0</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_stickiness_inverse_temperature(prev_choice)" class="doc doc-heading doc-heading-parameter">              <b><code>prev_choice</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>One-hot encoded previous choices,
shape (n_trials, n_bandits). Defaults to None.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ArrayLike</code></b> (              <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
)          –
          <div class="doc-md-description">
            <p>Choice probabilities, shape (n_trials, n_bandits)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax_stickiness_inverse_temperature</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">inverse_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">stickiness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">prev_choice</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function with choice stickiness, and optional inverse temperature</span>
<span class="sd">    parameter.</span>

<span class="sd">    The standard softmax function is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{\\beta \\cdot Q(a)}}{\\sum_{b} e^{\\beta \\cdot Q(b)}}</span>
<span class="sd">    $$</span>

<span class="sd">    With stickiness added:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{(Q(a) + \\kappa \\cdot same(a, a_{t-1}))/\\tau}}</span>
<span class="sd">    {\\sum_{b} e^{(Q(b) + \\kappa \\cdot same(b, a_{t-1}))/\\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    - $P(a)$ is the probability of choosing action $a$</span>
<span class="sd">    - $Q(a)$ is the value of action $a$</span>
<span class="sd">    - $\\beta$ is the inverse temperature parameter</span>
<span class="sd">    - $\kappa$ is the stickiness parameter</span>
<span class="sd">    - $same(a, a_{t-1})$ is 1 if $a$ matches the previous choice, 0 otherwise</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, shape</span>
<span class="sd">            `(n_trials, n_bandits)`. </span>
<span class="sd">            Note that this **does not**</span>
<span class="sd">            account for trial-wise dependencies, so each trial is treated</span>
<span class="sd">            independently (i.e., we use precomputed choices, therefore the </span>
<span class="sd">            precomputed choice on trial `t-1` can influence the choice on </span>
<span class="sd">            trial `t`, but this altered choice likelihood on trial `t` will not</span>
<span class="sd">            affect any subsequent trials since we rely on the precomputed</span>
<span class="sd">            choices provided).</span>
<span class="sd">            This can be useful to apply the same stickiness to</span>
<span class="sd">            all trials, but additional code will be required to account for</span>
<span class="sd">            trial-wise dependencies (i.e., the choice on trial `t-1`)</span>
<span class="sd">            influencing the choice on trial `t`, and this subsequently</span>
<span class="sd">            influencing trials `t+1` etc.).</span>
<span class="sd">        inverse_temperature (float, optional): Softmax inverse temperature,</span>
<span class="sd">            range [0, inf]. Higher values make choices more deterministic.</span>
<span class="sd">            Defaults to 1.0</span>
<span class="sd">        stickiness (float, optional): Weight given to previous choices, range</span>
<span class="sd">            (-inf, inf). Positive values increase probability of repeating</span>
<span class="sd">            choices. Defaults to 0.0</span>
<span class="sd">        prev_choice (ArrayLike, optional): One-hot encoded previous choices,</span>
<span class="sd">            shape (n_trials, n_bandits). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ArrayLike: Choice probabilities, shape (n_trials, n_bandits)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sticky_value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">stickiness</span> <span class="o">*</span> <span class="n">prev_choice</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">inverse_temperature</span> <span class="o">*</span> <span class="n">sticky_value</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">inverse_temperature</span> <span class="o">*</span> <span class="n">sticky_value</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.decision_rules.softmax_subtract_max" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax_subtract_max</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax_subtract_max</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_subtract_max(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.decision_rules.softmax_subtract_max(temperature)">temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function, with optional temperature parameter.</p>
<p>Subtracts the maximum value before applying softmax to avoid overflow.</p>
<p>In equation form, this is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{(Q(a) - \max_{b} Q(b)) / \tau}}
{\sum_{b} e^{(Q(b) - \max_{c} Q(c)) / \tau}}
\]</div>
<p>Where <code>P(a)</code> is the probability of choosing action <code>a</code>,
<code>Q(a)</code> is the value of action <code>a</code>, and <code>au</code> is the
temperature parameter.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_subtract_max(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, of shape
(n_trials, n_bandits)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.decision_rules.softmax_subtract_max(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax temperature, in range [0, inf].
Note that this is temperature rather than inverse temperature;
values are divided by this value. Defaults to 1.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ArrayLike</code></b> (              <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
)          –
          <div class="doc-md-description">
            <p>Choice probabilities, of shape (n_trials, n_bandits)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax_subtract_max</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function, with optional temperature parameter.</span>

<span class="sd">    Subtracts the maximum value before applying softmax to avoid overflow.</span>

<span class="sd">    In equation form, this is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{(Q(a) - \max_{b} Q(b)) / \\tau}}</span>
<span class="sd">    {\\sum_{b} e^{(Q(b) - \max_{c} Q(c)) / \\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    Where `P(a)` is the probability of choosing action `a`,</span>
<span class="sd">    `Q(a)` is the value of action `a`, and `\tau` is the</span>
<span class="sd">    temperature parameter.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, of shape</span>
<span class="sd">            (n_trials, n_bandits)</span>
<span class="sd">        temperature (float, optional): Softmax temperature, in range [0, inf].</span>
<span class="sd">            Note that this is temperature rather than inverse temperature;</span>
<span class="sd">            values are divided by this value. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ArrayLike: Choice probabilities, of shape (n_trials, n_bandits)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Subtract max value to avoid overflow</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">value</span> <span class="o">-</span> <span class="n">value</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">value</span> <span class="o">-</span> <span class="n">value</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">])</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
        <span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>