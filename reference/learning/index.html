
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Learning models - Behavioural Modelling</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#learning-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Behavioural Modelling" class="md-header__button md-logo" aria-label="Behavioural Modelling" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Behavioural Modelling
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Learning models
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2c-1.82 0-3.53.5-5 1.35C8 5.08 10 8.3 10 12s-2 6.92-5 8.65C6.47 21.5 8.18 22 10 22a10 10 0 0 0 10-10A10 10 0 0 0 10 2Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/the-wise-lab/behavioural-modelling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    the-wise-lab/behavioural-modelling
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Behavioural Modelling" class="md-nav__button md-logo" aria-label="Behavioural Modelling" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Behavioural Modelling
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/the-wise-lab/behavioural-modelling" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    the-wise-lab/behavioural-modelling
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="beta_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beta Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rescorla_wagner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rescorla-Wagner
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Planning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Planning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../planning/dynamic_programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../decision_rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decision Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/learning/beta_learning_models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Beta Model Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Planning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Planning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/planning/value_iteration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Making decision
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Making decision
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/decisions/simulating_choices/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulating choices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/decisions/decision_rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decision rules
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#behavioural_modelling.learning" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;learning
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;asymmetric_rescorla_wagner_update
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" asymmetric_rescorla_wagner_update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update(alpha_p)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update(alpha_n)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update(counterfactual_value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;counterfactual_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update(update_all_options)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;update_all_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;asymmetric_rescorla_wagner_update_choice
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" asymmetric_rescorla_wagner_update_choice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(outcome_key)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;outcome_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(alpha_p)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(alpha_n)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(n_actions)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;n_actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(counterfactual_value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;counterfactual_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(update_all_options)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;update_all_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;asymmetric_rescorla_wagner_update_choice_sticky
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" asymmetric_rescorla_wagner_update_choice_sticky">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(value_choice)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value_choice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(outcome_key)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;outcome_key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(alpha_p)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(alpha_n)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(stickiness)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stickiness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(n_actions)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;n_actions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(counterfactual_value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;counterfactual_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(update_all_options)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;update_all_options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;asymmetric_volatile_dynamic_rescorla_wagner_update_choice
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" asymmetric_volatile_dynamic_rescorla_wagner_update_choice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_base)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_base
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_volatility)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_volatility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_pos_neg)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_pos_neg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_interaction)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_interaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(n_actions)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;n_actions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;asymmetric_volatile_rescorla_wagner_single_value_update_choice
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" asymmetric_volatile_rescorla_wagner_single_value_update_choice">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_base)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_base
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_volatility)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_volatility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_pos_neg)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_pos_neg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_interaction)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_interaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(n_actions)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;n_actions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;asymmetric_volatile_rescorla_wagner_update
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" asymmetric_volatile_rescorla_wagner_update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_base)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_base
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_volatility)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_volatility
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_pos_neg)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_pos_neg
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_interaction)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha_interaction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.average_betas" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;average_betas
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" average_betas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.average_betas(beta1_params)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta1_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.average_betas(beta2_params)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta2_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.beta_mean_var" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;beta_mean_var
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" beta_mean_var">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.beta_mean_var(beta_params)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.choice_from_action_p" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;choice_from_action_p
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" choice_from_action_p">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.choice_from_action_p(key)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;key
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.choice_from_action_p(probs)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;probs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.choice_from_action_p(lapse)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;lapse
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.complement_counterfactual" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;complement_counterfactual
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" complement_counterfactual">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.complement_counterfactual(reward)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;reward
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.complement_counterfactual(chosen)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;chosen
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.generalised_beta_mean_var" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generalised_beta_mean_var
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" generalised_beta_mean_var">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.generalised_beta_mean_var(alpha)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;alpha
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.generalised_beta_mean_var(beta)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.generalised_beta_mean_var(a)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;a
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.generalised_beta_mean_var(b)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;b
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;leaky_beta_update
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" leaky_beta_update">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(estimate)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;estimate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(choices)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;choices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(outcomes)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;outcomes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(tau_p)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;tau_p
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(tau_n)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;tau_n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(decay)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;decay
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(update)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.leaky_beta_update(increment)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;increment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.multiply_beta_by_scalar" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;multiply_beta_by_scalar
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" multiply_beta_by_scalar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.multiply_beta_by_scalar(beta_params)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.multiply_beta_by_scalar(scalar)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;scalar
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax_stickiness" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;softmax_stickiness
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" softmax_stickiness">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax_stickiness(value)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax_stickiness(temperature)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax_stickiness(stickiness)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;stickiness
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.softmax_stickiness(prev_choice)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;prev_choice
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.sum_betas" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;sum_betas
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" sum_betas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.sum_betas(beta1_params)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta1_params
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#behavioural_modelling.learning.sum_betas(beta2_params)" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-parameter"></code>&nbsp;beta2_params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="learning-models">Learning models</h1>
<p>This module contains models of learning.</p>


<div class="doc doc-object doc-module">



<h2 id="behavioural_modelling.learning" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">learning</span>


</h2>

    <div class="doc doc-contents first">





<p><span class="doc-section-title">Modules:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.beta_models" href="beta_models/#behavioural_modelling.learning.beta_models">beta_models</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.rescorla_wagner" href="rescorla_wagner/#behavioural_modelling.learning.rescorla_wagner">rescorla_wagner</a></code></b>
          –
          <div class="doc-md-description">
            
          </div>
        </li>
    </ul>






<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update">asymmetric_volatile_rescorla_wagner_update</a></code></b>
            –
            <div class="doc-md-description">
              <p>Updates the estimated value of a state or action using a variant</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.average_betas" href="#behavioural_modelling.learning.average_betas">average_betas</a></code></b>
            –
            <div class="doc-md-description">
              <p>Average two beta distributions, weighted by W.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.beta_mean_var" href="#behavioural_modelling.learning.beta_mean_var">beta_mean_var</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate mean and variance of a beta distribution.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.choice_from_action_p" href="#behavioural_modelling.learning.choice_from_action_p">choice_from_action_p</a></code></b>
            –
            <div class="doc-md-description">
              <p>Choose an action from a set of action probabilities. Can take probabilities</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.complement_counterfactual" href="#behavioural_modelling.learning.complement_counterfactual">complement_counterfactual</a></code></b>
            –
            <div class="doc-md-description">
              <p>Counterfactual function that sets the value of unchosen actions to the</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.generalised_beta_mean_var" href="#behavioural_modelling.learning.generalised_beta_mean_var">generalised_beta_mean_var</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate mean and variance of a generalised beta distribution.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.leaky_beta_update" href="#behavioural_modelling.learning.leaky_beta_update">leaky_beta_update</a></code></b>
            –
            <div class="doc-md-description">
              <p>Update estimates using the (asymmetric) leaky beta model. </p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.multiply_beta_by_scalar" href="#behavioural_modelling.learning.multiply_beta_by_scalar">multiply_beta_by_scalar</a></code></b>
            –
            <div class="doc-md-description">
              <p>Multiply a beta distribution by a scalar.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.softmax" href="#behavioural_modelling.learning.softmax">softmax</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function, with optional temperature parameter.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.softmax_stickiness" href="#behavioural_modelling.learning.softmax_stickiness">softmax_stickiness</a></code></b>
            –
            <div class="doc-md-description">
              <p>Softmax function with choice stickiness, and optional temperature</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.sum_betas" href="#behavioural_modelling.learning.sum_betas">sum_betas</a></code></b>
            –
            <div class="doc-md-description">
              <p>Sum two beta distributions. This uses an approximation described in the following paper:</p>
            </div>
          </li>
    </ul>




<p><span class="doc-section-title">Attributes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.asymmetric_rescorla_wagner_update" href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update">asymmetric_rescorla_wagner_update</a></code></b>
              (<code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <span title="jax.typing.ArrayLike">ArrayLike</span>]</code>)
          –
          <div class="doc-md-description">
            <p>Updates the estimated value of a state or action using the Asymmetric</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice" href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice">asymmetric_rescorla_wagner_update_choice</a></code></b>
              (<code><span title="jax.Array">Array</span></code>)
          –
          <div class="doc-md-description">
            <p>Updates the value estimate using the asymmetric Rescorla-Wagner</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky" href="#behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky">asymmetric_rescorla_wagner_update_choice_sticky</a></code></b>
              (<code><span title="jax.Array">Array</span></code>)
          –
          <div class="doc-md-description">
            <p>Updates the value estimate using the asymmetric Rescorla-Wagner</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice" href="#behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice">asymmetric_volatile_dynamic_rescorla_wagner_update_choice</a></code></b>
              (<code><span title="jax.Array">Array</span></code>)
          –
          <div class="doc-md-description">
            <p>Updates the value estimate using a variant of the Rescorla-Wagner</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice">asymmetric_volatile_rescorla_wagner_single_value_update_choice</a></code></b>
              (<code><span title="jax.Array">Array</span></code>)
          –
          <div class="doc-md-description">
            <p>Updates the value estimate using the asymmetric volatile dynamic</p>
          </div>
        </li>
    </ul>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">asymmetric_rescorla_wagner_update</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">asymmetric_rescorla_wagner_update</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a></span><span class="p">[</span><span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="jax.jit">jit</span></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.rescorla_wagner.asymmetric_rescorla_wagner_update" href="rescorla_wagner/#behavioural_modelling.learning.rescorla_wagner.asymmetric_rescorla_wagner_update">asymmetric_rescorla_wagner_update</a></span><span class="p">,</span> <span class="n"><span title="jax.jit(static_argnames)">static_argnames</span></span><span class="o">=</span><span class="s1">&#39;counterfactual_value&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the estimated value of a state or action using the Asymmetric
Rescorla-Wagner learning rule.</p>
<p>The function calculates the prediction error as the difference between
the actual outcome and the current estimated value. It then updates the
estimated value based on the prediction error and the learning rate,
which is determined by whether the prediction error is positive or
negative.</p>
<p>Value estimates are only updated for chosen actions. For unchosen
actions, the prediction error is set to 0.</p>
<p>Counterfactual updating can be used to set the value of unchosen actions
according to a function of the value of chosen actions. This can be useful
in cases where the value of unchosen actions should be set to a specific
value, such as the negative of the value of chosen actions. By default this
function sets the value of unchosen actions to the complement of the value
of chosen actions:</p>
<pre><code class="language-python">counterfactual_value: callable = lambda reward, chosen: jnp.where(
    chosen == 1, 
    0.0, 
    1.0 - jnp.sum(reward * jnp.asarray(chosen == 1, dtype=reward.dtype))
)
</code></pre>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The current estimated value of a
state or action.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update(alpha_p)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_p</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate used when the
prediction error is positive.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update(alpha_n)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_n</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate used when the
prediction error is negative.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update(counterfactual_value)" class="doc doc-heading doc-heading-parameter">              <b><code>counterfactual_value</code></b>
</h4>              (<code>callable]</code>)
          –
          <div class="doc-md-description">
            <p>The value
to use for unchosen actions. This should be provided as a
callable function that returns a value. This will have
no effect if <code>update_all_options</code> is set to False.
The function takes as input the values of <code>outcome</code> and <code>chosen</code>
(i.e., the two elements of the <code>outcome_chosen</code> argument).
By default, this assumes that outcomes are binary and sets
the value of unchosen actions to the complement of the value
of chosen actions.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update(update_all_options)" class="doc doc-heading doc-heading-parameter">              <b><code>update_all_options</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Whether to update the value
estimates for all options, regardless of whether they were
chosen. Defaults to False.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <span title="jax.typing.ArrayLike">ArrayLike</span>]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[jax.typing.ArrayLike, jax.typing.ArrayLike]: The updated value
and the prediction error.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">asymmetric_rescorla_wagner_update_choice</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">asymmetric_rescorla_wagner_update_choice</span><span class="p">:</span> <span class="n"><span title="jax.Array">Array</span></span> <span class="o">=</span> <span class="n"><span title="jax.jit">jit</span></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.rescorla_wagner.asymmetric_rescorla_wagner_update_choice" href="rescorla_wagner/#behavioural_modelling.learning.rescorla_wagner.asymmetric_rescorla_wagner_update_choice">asymmetric_rescorla_wagner_update_choice</a></span><span class="p">,</span> <span class="n"><span title="jax.jit(static_argnums)">static_argnums</span></span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the value estimate using the asymmetric Rescorla-Wagner
algorithm, and chooses an option based on the softmax function.</p>
<p>See <code>asymmetric_rescorla_wagner_update</code> for details on the learning
rule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The current value estimate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(outcome_key)" class="doc doc-heading doc-heading-parameter">              <b><code>outcome_key</code></b>
</h4>              (<code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <span title="jax.random.PRNGKey">PRNGKey</span>]</code>)
          –
          <div class="doc-md-description">
            <p>A tuple containing the outcome and the PRNG key.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(alpha_p)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_p</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate for positive outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(alpha_n)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_n</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate for negative outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The temperature parameter for softmax function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(n_actions)" class="doc doc-heading doc-heading-parameter">              <b><code>n_actions</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The number of actions to choose from.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(counterfactual_value)" class="doc doc-heading doc-heading-parameter">              <b><code>counterfactual_value</code></b>
</h4>              (<code>callable]</code>)
          –
          <div class="doc-md-description">
            <p>The value
to use for unchosen actions. This should be provided as a
callable function that returns a value. This will have
no effect if <code>update_all_options</code> is set to False.
The function takes as input the values of <code>outcome</code> and <code>chosen</code>
(i.e., the two elements of the <code>outcome_chosen</code> argument).
By default, this assumes that outcomes are binary and sets
the value of unchosen actions to the complement of the value
of chosen actions.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice(update_all_options)" class="doc doc-heading doc-heading-parameter">              <b><code>update_all_options</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Whether to update the value
estimates for all options, regardless of whether they were</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="jax.Array">Array</span></code>
          –
          <div class="doc-md-description">
            <p>Tuple[jax.Array, Tuple[jax.Array, jax.Array, int,
jax.Array]]:
- updated_value (jax.Array): The updated value estimate.
- output_tuple (Tuple[jax.Array, jax.Array, int,
    jax.Array]):
    - value (jax.Array): The original value estimate.
    - choice_p (jax.Array): The choice probabilities.
    - choice (int): The chosen action.
    - choice_array (jax.Array): The chosen action in one-hot
        format.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">asymmetric_rescorla_wagner_update_choice_sticky</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">asymmetric_rescorla_wagner_update_choice_sticky</span><span class="p">:</span> <span class="n"><span title="jax.Array">Array</span></span> <span class="o">=</span> <span class="n"><span title="jax.jit">jit</span></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.rescorla_wagner.asymmetric_rescorla_wagner_update_choice_sticky" href="rescorla_wagner/#behavioural_modelling.learning.rescorla_wagner.asymmetric_rescorla_wagner_update_choice_sticky">asymmetric_rescorla_wagner_update_choice_sticky</a></span><span class="p">,</span> <span class="n"><span title="jax.jit(static_argnums)">static_argnums</span></span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the value estimate using the asymmetric Rescorla-Wagner
algorithm, and chooses an option based on the softmax function.</p>
<p>Incorporates additional choice stickiness parameter, such that
the probability of choosing the same option as the previous trial
is increased (or decreased if the value is negative).</p>
<p>See <code>asymmetric_rescorla_wagner_update</code> for details on the learning
rule.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(value_choice)" class="doc doc-heading doc-heading-parameter">              <b><code>value_choice</code></b>
</h4>              (<code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <span title="jax.typing.ArrayLike">ArrayLike</span>]</code>)
          –
          <div class="doc-md-description">
            <p>A tuple containing the current value estimate and the previous
choice. The previous choice should be a one-hot encoded array
of shape (n_actions,) where 1 indicates the chosen action and
0 indicates the unchosen actions.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(outcome_key)" class="doc doc-heading doc-heading-parameter">              <b><code>outcome_key</code></b>
</h4>              (<code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <span title="jax.random.PRNGKey">PRNGKey</span>]</code>)
          –
          <div class="doc-md-description">
            <p>A tuple containing the outcome and the PRNG key.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(alpha_p)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_p</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate for positive outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(alpha_n)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_n</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate for negative outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The temperature parameter for softmax function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(stickiness)" class="doc doc-heading doc-heading-parameter">              <b><code>stickiness</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The stickiness parameter for softmax function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(n_actions)" class="doc doc-heading doc-heading-parameter">              <b><code>n_actions</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The number of actions to choose from.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(counterfactual_value)" class="doc doc-heading doc-heading-parameter">              <b><code>counterfactual_value</code></b>
</h4>              (<code>callable]</code>)
          –
          <div class="doc-md-description">
            <p>The value
to use for unchosen actions. This should be provided as a
callable function that returns a value. This will have
no effect if <code>update_all_options</code> is set to False.
The function takes as input the values of <code>outcome</code> and <code>chosen</code>
(i.e., the two elements of the <code>outcome_chosen</code> argument).
Defaults to <code>lambda x, y: (1 - x) * (1 - y)</code>, which assumes
outcomes are binary (0 or 1), and sets the value of unchosen
actions to complement the value of chosen actions (i.e.,
a chosen value of 1 will set the unchosen value to 0 and
vice versa).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_rescorla_wagner_update_choice_sticky(update_all_options)" class="doc doc-heading doc-heading-parameter">              <b><code>update_all_options</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>)
          –
          <div class="doc-md-description">
            <p>Whether to update the value
estimates for all options, regardless of whether they were</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="jax.Array">Array</span></code>
          –
          <div class="doc-md-description">
            <p>Tuple[jax.Array, Tuple[jax.Array, jax.Array, int,
jax.Array]]:
- updated_value (jax.Array): The updated value estimate.
- output_tuple (Tuple[jax.Array, jax.Array, int,
    jax.Array]):
    - value (jax.Array): The original value estimate.
    - choice_p (jax.Array): The choice probabilities.
    - choice (int): The chosen action.
    - choice_array (jax.Array): The chosen action in one-hot
        format.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">asymmetric_volatile_dynamic_rescorla_wagner_update_choice</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">asymmetric_volatile_dynamic_rescorla_wagner_update_choice</span><span class="p">:</span> <span class="n"><span title="jax.Array">Array</span></span> <span class="o">=</span> <span class="n"><span title="jax.jit">jit</span></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.rescorla_wagner.asymmetric_volatile_dynamic_rescorla_wagner_update_choice" href="rescorla_wagner/#behavioural_modelling.learning.rescorla_wagner.asymmetric_volatile_dynamic_rescorla_wagner_update_choice">asymmetric_volatile_dynamic_rescorla_wagner_update_choice</a></span><span class="p">,</span> <span class="n"><span title="jax.jit(static_argnums)">static_argnums</span></span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,))</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the value estimate using a variant of the Rescorla-Wagner
learning rule that adjusts learning rate based on volatility
and prediction error sign, and chooses an option based on the softmax
function.</p>
<p>Note that learning rates for this function are transformed using a
sigmoid function to ensure they are between 0 and 1. The raw
parameter values supplied to the function must therefore be
unbounded.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The current value estimate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_base)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_base</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The base learning rate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_volatility)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_volatility</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for volatile
outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_pos_neg)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_pos_neg</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for positive and
negative prediction errors.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(alpha_interaction)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_interaction</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for the
interaction between volatility and prediction error sign.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The temperature parameter for softmax function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_dynamic_rescorla_wagner_update_choice(n_actions)" class="doc doc-heading doc-heading-parameter">              <b><code>n_actions</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The number of actions to choose from.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="jax.Array">Array</span></code>
          –
          <div class="doc-md-description">
            <p>Tuple[jax.Array, Tuple[jax.typing.ArrayLike, jax.Array, int,
jax.Array]]:
- updated_value (jax.Array): The updated value estimate.
- output_tuple (Tuple[jax.Array, jax.Array, int,
    jax.Array]):
    - value (jax.Array): The original value estimate.
    - choice_p (jax.Array): The choice probabilities.
    - choice (int): The chosen action.
    - choice_array (jax.Array): The chosen action in one-hot
        format.</p>
          </div>
        </li>
    </ul>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <span class="doc doc-object-name doc-attribute-name">asymmetric_volatile_rescorla_wagner_single_value_update_choice</span>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">asymmetric_volatile_rescorla_wagner_single_value_update_choice</span><span class="p">:</span> <span class="n"><span title="jax.Array">Array</span></span> <span class="o">=</span> <span class="n"><span title="jax.jit">jit</span></span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" title="behavioural_modelling.learning.rescorla_wagner.asymmetric_volatile_rescorla_wagner_single_value_update_choice" href="rescorla_wagner/#behavioural_modelling.learning.rescorla_wagner.asymmetric_volatile_rescorla_wagner_single_value_update_choice">asymmetric_volatile_rescorla_wagner_single_value_update_choice</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the value estimate using the asymmetric volatile dynamic
Rescorla-Wagner algorithm, and chooses an option based on the softmax
function.</p>
<p>This version of the function is designed for cases where the a single
value is being learnt, and this value is used to determine which of
two options to choose. In practice, the value of option 1 is learnt,
and the value of option 2 is set to 1 - value. This is appropriate
for cases where the value of one option is the complement of the other.</p>
<p>Note that learning rates for this function are transformed using a
sigmoid function to ensure they are between 0 and 1. The raw
parameter values supplied to the function must therefore be
unbounded.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The current value estimate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_base)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_base</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The base learning rate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_volatility)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_volatility</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for volatile
outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_pos_neg)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_pos_neg</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for positive and
negative prediction errors.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(alpha_interaction)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_interaction</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for the
interaction between volatility and prediction error sign.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The temperature parameter for softmax function.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_single_value_update_choice(n_actions)" class="doc doc-heading doc-heading-parameter">              <b><code>n_actions</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>The number of actions to choose from.</p>
          </div>
        </li>
    </ul>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">asymmetric_volatile_rescorla_wagner_update</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">asymmetric_volatile_rescorla_wagner_update</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(value)">value</a></span><span class="p">:</span> <span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n">outcome_chosen_volatility</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a></span><span class="p">[</span><span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">],</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_base)">alpha_base</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_volatility)">alpha_volatility</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_pos_neg)">alpha_pos_neg</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_interaction)">alpha_interaction</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a></span><span class="p">[</span><span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a></span><span class="p">[</span><span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><span title="jax.typing.ArrayLike">ArrayLike</span></span><span class="p">]]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Updates the estimated value of a state or action using a variant
of the Rescorla-Wagner learning rule that incorporates adjusting
the learning rate based on both volatility and prediction error sign.</p>
<p>Note that learning rates for this function are transformed using a
sigmoid function to ensure they are between 0 and 1. The raw
parameter values supplied to the function must therefore be
unbounded.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The current estimated value of a
state or action.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_base)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_base</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The base learning rate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_volatility)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_volatility</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for volatile
outcomes.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_pos_neg)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_pos_neg</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for positive and
negative prediction errors.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.asymmetric_volatile_rescorla_wagner_update(alpha_interaction)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha_interaction</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>The learning rate adjustment for the
interaction between volatility and prediction error sign.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="jax.typing.ArrayLike">ArrayLike</span>, <span title="jax.typing.ArrayLike">ArrayLike</span>]]</code>
          –
          <div class="doc-md-description">
            <p>Tuple[jax.typing.ArrayLike, Tuple[jax.typing.ArrayLike,
jax.typing.ArrayLike]]:
- updated_value (jax.typing.ArrayLike): The updated value estimate.
- output_tuple (Tuple[jax.typing.ArrayLike, jax.typing.ArrayLike]):
    - value (jax.typing.ArrayLike): The original value estimate.
    - prediction_error (jax.typing.ArrayLike): The prediction
      error.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/rescorla_wagner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">asymmetric_volatile_rescorla_wagner_update</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">outcome_chosen_volatility</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span>
        <span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
        <span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
        <span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="n">alpha_base</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">alpha_volatility</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">alpha_pos_neg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">alpha_interaction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span>
    <span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">typing</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span>
<span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the estimated value of a state or action using a variant</span>
<span class="sd">    of the Rescorla-Wagner learning rule that incorporates adjusting</span>
<span class="sd">    the learning rate based on both volatility and prediction error sign.</span>

<span class="sd">    Note that learning rates for this function are transformed using a</span>
<span class="sd">    sigmoid function to ensure they are between 0 and 1. The raw</span>
<span class="sd">    parameter values supplied to the function must therefore be</span>
<span class="sd">    unbounded.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (jax.typing.ArrayLike): The current estimated value of a</span>
<span class="sd">            state or action.</span>
<span class="sd">        outcome_chosen_volatility (Tuple[jax.typing.ArrayLike, jax.typing.ArrayLike,</span>
<span class="sd">            jax.typing.ArrayLike]): A tuple containing the outcome, the chosen</span>
<span class="sd">            action, and the volatility indicator. The outcome is a float or an</span>
<span class="sd">            array (e.g., for a single outcome or multiple outcomes). The chosen</span>
<span class="sd">            action is a one-hot encoded array of shape (n_actions,) where 1</span>
<span class="sd">            indicates the chosen action and 0 indicates the unchosen actions.</span>
<span class="sd">            The volatility indicator is a binary value that indicates whether</span>
<span class="sd">            the outcome is volatile (1) or stable (0).</span>
<span class="sd">        alpha_base (float): The base learning rate.</span>
<span class="sd">        alpha_volatility (float): The learning rate adjustment for volatile</span>
<span class="sd">            outcomes.</span>
<span class="sd">        alpha_pos_neg (float): The learning rate adjustment for positive and</span>
<span class="sd">            negative prediction errors.</span>
<span class="sd">        alpha_interaction (float): The learning rate adjustment for the</span>
<span class="sd">            interaction between volatility and prediction error sign.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[jax.typing.ArrayLike, Tuple[jax.typing.ArrayLike,</span>
<span class="sd">            jax.typing.ArrayLike]]:</span>
<span class="sd">            - updated_value (jax.typing.ArrayLike): The updated value estimate.</span>
<span class="sd">            - output_tuple (Tuple[jax.typing.ArrayLike, jax.typing.ArrayLike]):</span>
<span class="sd">                - value (jax.typing.ArrayLike): The original value estimate.</span>
<span class="sd">                - prediction_error (jax.typing.ArrayLike): The prediction</span>
<span class="sd">                  error.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Unpack the outcome and the chosen action</span>
    <span class="n">outcome</span><span class="p">,</span> <span class="n">chosen</span><span class="p">,</span> <span class="n">volatility_indicator</span> <span class="o">=</span> <span class="n">outcome_chosen_volatility</span>

    <span class="c1"># Calculate the prediction error</span>
    <span class="n">prediction_error</span> <span class="o">=</span> <span class="n">outcome</span> <span class="o">-</span> <span class="n">value</span>

    <span class="c1"># Set prediction error to 0 for unchosen actions</span>
    <span class="n">prediction_error</span> <span class="o">=</span> <span class="n">prediction_error</span> <span class="o">*</span> <span class="n">chosen</span>

    <span class="c1"># Determine whether the error is positive (1) or negative (-1)</span>
    <span class="n">PE_sign</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">prediction_error</span><span class="p">)</span>

    <span class="c1"># Compute interaction term (volatility_indicator * error_sign)</span>
    <span class="n">interaction_term</span> <span class="o">=</span> <span class="n">volatility_indicator</span> <span class="o">*</span> <span class="n">PE_sign</span>

    <span class="c1"># Compute the dynamic learning rate using base, volatility, and interaction terms</span>
    <span class="c1"># Remember we can&#39;t use if else statements here because JAX doesn&#39;t tolerate them</span>
    <span class="c1"># Use adjusted learning rates for positive/negative prediction errors</span>
    <span class="n">alpha_t</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span>
        <span class="n">alpha_base</span>
        <span class="o">+</span> <span class="n">alpha_volatility</span> <span class="o">*</span> <span class="n">volatility_indicator</span>
        <span class="o">+</span> <span class="n">alpha_pos_neg</span> <span class="o">*</span> <span class="n">PE_sign</span>
        <span class="o">+</span> <span class="n">alpha_interaction</span> <span class="o">*</span> <span class="n">interaction_term</span>
    <span class="p">)</span>

    <span class="c1"># Update the value</span>
    <span class="n">updated_value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">alpha_t</span> <span class="o">*</span> <span class="n">prediction_error</span>

    <span class="k">return</span> <span class="n">updated_value</span><span class="p">,</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">prediction_error</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.average_betas" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">average_betas</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">average_betas</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.average_betas(beta1_params)">beta1_params</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.average_betas(beta2_params)">beta2_params</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n">W1</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">W2</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Average two beta distributions, weighted by W.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.average_betas(beta1_params)" class="doc doc-heading doc-heading-parameter">              <b><code>beta1_params</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameters of first beta distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.average_betas(beta2_params)" class="doc doc-heading doc-heading-parameter">              <b><code>beta2_params</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameters of second beta distribution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="jax.numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>jnp.ndarray: New beta distribution parameters.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/beta_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">average_betas</span><span class="p">(</span>
    <span class="n">beta1_params</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">beta2_params</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">W1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="n">W2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Average two beta distributions, weighted by W.</span>

<span class="sd">    Args:</span>
<span class="sd">        beta1_params (ArrayLike): Parameters of first beta distribution.</span>
<span class="sd">        beta2_params (ArrayLike): Parameters of second beta distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: New beta distribution parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extract parameters</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">beta1_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">beta1_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">beta2_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">beta2_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calculate average</span>
    <span class="n">a_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">W1</span> <span class="o">*</span> <span class="n">a1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">W2</span> <span class="o">*</span> <span class="n">a2</span><span class="p">)</span>
    <span class="n">b_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">W1</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">W2</span> <span class="o">*</span> <span class="n">b2</span><span class="p">)</span>

    <span class="c1"># Return new parameters</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a_new</span><span class="p">,</span> <span class="n">b_new</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.beta_mean_var" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">beta_mean_var</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">beta_mean_var</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.beta_mean_var(beta_params)">beta_params</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a></span><span class="p">[</span><span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate mean and variance of a beta distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.beta_mean_var(beta_params)" class="doc doc-heading doc-heading-parameter">              <b><code>beta_params</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameters of the beta distribution. Of shape (n_options, 2),</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<span title="numpy.typing.ArrayLike">ArrayLike</span>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
          –
          <div class="doc-md-description">
            <p>tuple[ArrayLike, ArrayLike]: Mean and variance of the beta distribution.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/beta_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">beta_mean_var</span><span class="p">(</span><span class="n">beta_params</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate mean and variance of a beta distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        beta_params (ArrayLike): Parameters of the beta distribution. Of shape (n_options, 2),</span>
<span class="sd">        where the first dimension represents the number of options (each of which has its own</span>
<span class="sd">        beta distribution), and the second dimension represents the alpha and beta parameters</span>
<span class="sd">        of each beta distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[ArrayLike, ArrayLike]: Mean and variance of the beta distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">beta_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">beta_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">var</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.choice_from_action_p" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">choice_from_action_p</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">choice_from_action_p</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.choice_from_action_p(key)">key</a></span><span class="p">:</span> <span class="n"><span title="jax.random.PRNGKey">PRNGKey</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.choice_from_action_p(probs)">probs</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.choice_from_action_p(lapse)">lapse</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Choose an action from a set of action probabilities. Can take probabilities
in the form of an n-dimensional array, where the last dimension is the
number of actions.</p>
<p>Noise is added to the choice, with probability <code>lapse</code>. This means that
on "lapse" trials, the subject will choose an action uniformly at random.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.choice_from_action_p(key)" class="doc doc-heading doc-heading-parameter">              <b><code>key</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>)
          –
          <div class="doc-md-description">
            <p>Jax random key</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.choice_from_action_p(probs)" class="doc doc-heading doc-heading-parameter">              <b><code>probs</code></b>
</h4>              (<code><span title="np.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>N-dimension array of action probabilities, of shape (..., n_actions)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.choice_from_action_p(lapse)" class="doc doc-heading doc-heading-parameter">              <b><code>lapse</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>Probability of lapse. Defaults to 0.0.</p>
          </div>
        </li>
    </ul>
        <p>Returns:
    int: Chosen action</p>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/utils.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">choice_from_action_p</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">,</span> <span class="n">probs</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">lapse</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Choose an action from a set of action probabilities. Can take probabilities</span>
<span class="sd">    in the form of an n-dimensional array, where the last dimension is the</span>
<span class="sd">    number of actions.</span>

<span class="sd">    Noise is added to the choice, with probability `lapse`. This means that</span>
<span class="sd">    on &quot;lapse&quot; trials, the subject will choose an action uniformly at random.</span>

<span class="sd">    Args:</span>
<span class="sd">        key (int): Jax random key</span>
<span class="sd">        probs (np.ndarray): N-dimension array of action probabilities, of shape (..., n_actions)</span>
<span class="sd">        lapse (float, optional): Probability of lapse. Defaults to 0.0.</span>
<span class="sd">    Returns:</span>
<span class="sd">        int: Chosen action</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Reshape probs</span>
    <span class="n">probs_reshaped</span> <span class="o">=</span> <span class="n">probs</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">probs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># Split keys so that we have one for each index in the first</span>
    <span class="c1"># dimension of probs</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">probs_reshaped</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Get choices</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="n">choice_func_vmap</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">probs_reshaped</span><span class="p">,</span> <span class="n">lapse</span><span class="p">)</span>

    <span class="c1"># Reshape choices</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="n">choices</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">choices</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.complement_counterfactual" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">complement_counterfactual</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">complement_counterfactual</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.complement_counterfactual(reward)">reward</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.complement_counterfactual(chosen)">chosen</a></span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Counterfactual function that sets the value of unchosen actions to the
complement of the value of chosen actions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.complement_counterfactual(reward)" class="doc doc-heading doc-heading-parameter">              <b><code>reward</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>The reward received.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.complement_counterfactual(chosen)" class="doc doc-heading doc-heading-parameter">              <b><code>chosen</code></b>
</h4>              (<code><span title="jax.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>A binary array indicating which
action(s) were chosen.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          –
          <div class="doc-md-description">
            <p>jax.typing.ArrayLike: The counterfactual value.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/rescorla_wagner.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">complement_counterfactual</span><span class="p">(</span><span class="n">reward</span><span class="p">,</span> <span class="n">chosen</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Counterfactual function that sets the value of unchosen actions to the</span>
<span class="sd">    complement of the value of chosen actions.</span>

<span class="sd">    Args:</span>
<span class="sd">        reward (jax.typing.ArrayLike): The reward received.</span>
<span class="sd">        chosen (jax.typing.ArrayLike): A binary array indicating which</span>
<span class="sd">            action(s) were chosen.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jax.typing.ArrayLike: The counterfactual value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">chosen</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> 
        <span class="mf">0.0</span><span class="p">,</span> 
        <span class="mf">1.0</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">reward</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">chosen</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">reward</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.generalised_beta_mean_var" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">generalised_beta_mean_var</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generalised_beta_mean_var</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.generalised_beta_mean_var(alpha)">alpha</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.generalised_beta_mean_var(beta)">beta</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.generalised_beta_mean_var(a)">a</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.generalised_beta_mean_var(b)">b</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate mean and variance of a generalised beta distribution.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.generalised_beta_mean_var(alpha)" class="doc doc-heading doc-heading-parameter">              <b><code>alpha</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Alpha parameter of the beta distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.generalised_beta_mean_var(beta)" class="doc doc-heading doc-heading-parameter">              <b><code>beta</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Beta parameter of the beta distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.generalised_beta_mean_var(a)" class="doc doc-heading doc-heading-parameter">              <b><code>a</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Lower bound of the beta distribution.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.generalised_beta_mean_var(b)" class="doc doc-heading doc-heading-parameter">              <b><code>b</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Upper bound of the beta distribution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><a class="autorefs autorefs-external" title="typing.Tuple" href="https://docs.python.org/3/library/typing.html#typing.Tuple">Tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
          –
          <div class="doc-md-description">
            <p>tuple[float, float]: Mean and variance of the beta distribution.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/beta_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">generalised_beta_mean_var</span><span class="p">(</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">beta</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate mean and variance of a generalised beta distribution.</span>

<span class="sd">    Args:</span>
<span class="sd">        alpha (float): Alpha parameter of the beta distribution.</span>
<span class="sd">        beta (float): Beta parameter of the beta distribution.</span>
<span class="sd">        a (float): Lower bound of the beta distribution.</span>
<span class="sd">        b (float): Upper bound of the beta distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        tuple[float, float]: Mean and variance of the beta distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span>
    <span class="n">var</span> <span class="o">=</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="n">beta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">mean</span><span class="p">,</span> <span class="n">var</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.leaky_beta_update" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">leaky_beta_update</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">leaky_beta_update</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(estimate)">estimate</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(choices)">choices</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(tau_p)">tau_p</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(tau_n)">tau_n</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(decay)">decay</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(update)">update</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.leaky_beta_update(increment)">increment</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Update estimates using the (asymmetric) leaky beta model. </p>
<p>This models represents the probability of the outcome associated with each option (e.g., bandits in a bandit task)
as a beta distribution.</p>
<p>Values are updated according to the following equations:</p>
<div class="arithmatex">\[
A_i^{t+1} = \lambda \cdot A_i^{t} + outcome_t \cdot \tau^{+}
\]</div>
<div class="arithmatex">\[
B_i^{t+1} = \lambda \cdot B_i^{t} + (1-outcome_t) \cdot \tau^{-}
\]</div>
<p>This function also allows for updating to be turned off (i.e., the estimate is not updated at all) and for incrementing
to be turned off (i.e., decay is applied, but the outcome is not registered).</p>
<p>Only chosen options incremented, but all options decay.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(estimate)" class="doc doc-heading doc-heading-parameter">              <b><code>estimate</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Alpha and beta estimates for this trial. Should be an array of shape (n, 2) where</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(choices)" class="doc doc-heading doc-heading-parameter">              <b><code>choices</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Choices made in this trial. Should have as many entries as there are options, with</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(outcomes)" class="doc doc-heading doc-heading-parameter">              <b><code>outcomes</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Observed outcome for this trial.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(tau_p)" class="doc doc-heading doc-heading-parameter">              <b><code>tau_p</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Update rate for outcomes equal to 1.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(tau_n)" class="doc doc-heading doc-heading-parameter">              <b><code>tau_n</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Update rate for outcomes equal to 0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(decay)" class="doc doc-heading doc-heading-parameter">              <b><code>decay</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Decay rate.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(update)" class="doc doc-heading doc-heading-parameter">              <b><code>update</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to update the estimate. If 0, the estimate is not updated (i.e., no decay is</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.leaky_beta_update(increment)" class="doc doc-heading doc-heading-parameter">              <b><code>increment</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Whether to increment the estimate. If 0, the estimate is not incremented but</p>
          </div>
        </li>
    </ul>
        <p>Returns:
    jnp.ndarray: Updated value estimates for this trial, with one entry per bandit.</p>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/beta_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">leaky_beta_update</span><span class="p">(</span>
    <span class="n">estimate</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">choices</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">outcome</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">tau_p</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">tau_n</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">decay</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">update</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">increment</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update estimates using the (asymmetric) leaky beta model. </span>

<span class="sd">    This models represents the probability of the outcome associated with each option (e.g., bandits in a bandit task)</span>
<span class="sd">    as a beta distribution.</span>

<span class="sd">    Values are updated according to the following equations:</span>

<span class="sd">    $$</span>
<span class="sd">    A_i^{t+1} = \\lambda \\cdot A_i^{t} + outcome_t \\cdot \\tau^{+}</span>
<span class="sd">    $$</span>

<span class="sd">    $$</span>
<span class="sd">    B_i^{t+1} = \\lambda \\cdot B_i^{t} + (1-outcome_t) \\cdot \\tau^{-}</span>
<span class="sd">    $$</span>

<span class="sd">    This function also allows for updating to be turned off (i.e., the estimate is not updated at all) and for incrementing</span>
<span class="sd">    to be turned off (i.e., decay is applied, but the outcome is not registered).</span>

<span class="sd">    Only chosen options incremented, but all options decay.</span>

<span class="sd">    Args:</span>
<span class="sd">        estimate (ArrayLike): Alpha and beta estimates for this trial. Should be an array of shape (n, 2) where</span>
<span class="sd">        the first dimension represents the alpha and beta parameters of the beta distribution and the second</span>
<span class="sd">        dimension represents the number of option.</span>
<span class="sd">        choices (ArrayLike): Choices made in this trial. Should have as many entries as there are options, with</span>
<span class="sd">        zeros for non-chosen options and ones for chosen options (i.e., one-hot encoded).</span>
<span class="sd">        outcomes (float): Observed outcome for this trial.</span>
<span class="sd">        tau_p (float): Update rate for outcomes equal to 1.</span>
<span class="sd">        tau_n (float): Update rate for outcomes equal to 0.</span>
<span class="sd">        decay (float): Decay rate.</span>
<span class="sd">        update (int, optional): Whether to update the estimate. If 0, the estimate is not updated (i.e., no decay is</span>
<span class="sd">        applied, and the outcome of the trial does not affect the outcome). Defaults to 1.</span>
<span class="sd">        increment (int, optional): Whether to increment the estimate. If 0, the estimate is not incremented but</span>
<span class="sd">        decay is applied. Defaults to 1.</span>
<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: Updated value estimates for this trial, with one entry per bandit.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># For each parameter, we apply the decay to (previous value - 1) so that we are in effect</span>
    <span class="c1"># treating 1 as the baseline value. This is helpful becuase values of &lt; 1 can produce</span>
    <span class="c1"># strange-looking distributions (e.g., with joint peaks at 0 and 1). Keeping values</span>
    <span class="c1"># &gt; 1 ensures that the baseline distribution (ignoring any evidence we&#39;ve observed)</span>
    <span class="c1"># is a flat distribution between 0 and 1. This also generally aids parameter recovery.</span>

    <span class="c1"># Make sure any outcomes &gt; 1 are set to 1</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">outcome</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Update alpha</span>
    <span class="n">update_1</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">decay</span> <span class="o">*</span> <span class="p">(</span><span class="n">estimate</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="p">(</span><span class="n">tau_p</span> <span class="o">*</span> <span class="p">(</span><span class="n">choices</span> <span class="o">*</span> <span class="n">outcome</span><span class="p">)</span> <span class="o">*</span> <span class="n">increment</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">estimate</span> <span class="o">=</span> <span class="n">estimate</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="p">(</span><span class="n">update</span> <span class="o">*</span> <span class="n">update_1</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">update</span><span class="p">)</span> <span class="o">*</span> <span class="n">estimate</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="c1"># Update beta</span>
    <span class="n">update_2</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">1</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">decay</span> <span class="o">*</span> <span class="p">(</span><span class="n">estimate</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="o">+</span> <span class="p">(</span><span class="n">tau_n</span> <span class="o">*</span> <span class="p">(</span><span class="n">choices</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">outcome</span><span class="p">))</span> <span class="o">*</span> <span class="n">increment</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">estimate</span> <span class="o">=</span> <span class="n">estimate</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span>
        <span class="p">(</span><span class="n">update</span> <span class="o">*</span> <span class="n">update_2</span><span class="p">)</span> <span class="o">+</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">update</span><span class="p">)</span> <span class="o">*</span> <span class="n">estimate</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">estimate</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.multiply_beta_by_scalar" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">multiply_beta_by_scalar</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">multiply_beta_by_scalar</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.multiply_beta_by_scalar(beta_params)">beta_params</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.multiply_beta_by_scalar(scalar)">scalar</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Multiply a beta distribution by a scalar.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.multiply_beta_by_scalar(beta_params)" class="doc doc-heading doc-heading-parameter">              <b><code>beta_params</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameters of beta distribution. Of shape (n_options, 2),</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.multiply_beta_by_scalar(scalar)" class="doc doc-heading doc-heading-parameter">              <b><code>scalar</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
          –
          <div class="doc-md-description">
            <p>Scalar to multiply beta distribution by.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="jax.numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>jnp.ndarray: New beta distribution parameters, specified as [a, b].</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/beta_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">multiply_beta_by_scalar</span><span class="p">(</span><span class="n">beta_params</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">scalar</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multiply a beta distribution by a scalar.</span>

<span class="sd">    Args:</span>
<span class="sd">        beta_params (ArrayLike): Parameters of beta distribution. Of shape (n_options, 2),</span>
<span class="sd">        where the first dimension represents the number of options (each of which has its own</span>
<span class="sd">        beta distribution), and the second dimension represents the alpha and beta parameters</span>
<span class="sd">        of each beta distribution.</span>
<span class="sd">        scalar (float): Scalar to multiply beta distribution by.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: New beta distribution parameters, specified as [a, b].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extract parameters</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">beta_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">beta_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calculate mean and variance</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">beta_mean_var</span><span class="p">(</span><span class="n">beta_params</span><span class="p">)</span>

    <span class="c1"># Scale mean and variance</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">*</span> <span class="n">scalar</span>
    <span class="n">var</span> <span class="o">=</span> <span class="n">var</span> <span class="o">*</span> <span class="n">scalar</span><span class="o">**</span><span class="mi">2</span>

    <span class="c1"># Calculate new parameters</span>
    <span class="n">a_new</span> <span class="o">=</span> <span class="n">mean</span> <span class="o">*</span> <span class="p">((</span><span class="n">mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mean</span><span class="p">))</span> <span class="o">/</span> <span class="n">var</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">b_new</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">mean</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mean</span><span class="p">))</span> <span class="o">/</span> <span class="n">var</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Return new parameters</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a_new</span><span class="p">,</span> <span class="n">b_new</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.softmax" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.softmax(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.softmax(temperature)">temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function, with optional temperature parameter.</p>
<p>In equation form, this is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{Q(a) / \tau}}{\sum_{b} e^{Q(b) / \tau}}
\]</div>
<p>Where <code>P(a)</code> is the probability of choosing action <code>a</code>,
<code>Q(a)</code> is the value of action <code>a</code>, and <code>au</code> is the
temperature parameter.</p>
<p>Note that the value of the temperature parameter will
depend on the range of the values of the Q function.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.softmax(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, of shape
(n_trials, n_bandits)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.softmax(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax temperature, in range [0, inf].
Note that this is temperature rather than inverse temperature;
values are divided by this value. Higher values make choices less
deterministic. Defaults to 1.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ArrayLike</code></b> (              <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
)          –
          <div class="doc-md-description">
            <p>Choice probabilities, of shape (n_trials, n_bandits)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function, with optional temperature parameter.</span>

<span class="sd">    In equation form, this is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{Q(a) / \\tau}}{\\sum_{b} e^{Q(b) / \\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    Where `P(a)` is the probability of choosing action `a`,</span>
<span class="sd">    `Q(a)` is the value of action `a`, and `\tau` is the</span>
<span class="sd">    temperature parameter.</span>

<span class="sd">    Note that the value of the temperature parameter will</span>
<span class="sd">    depend on the range of the values of the Q function.</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, of shape</span>
<span class="sd">            (n_trials, n_bandits)</span>
<span class="sd">        temperature (float, optional): Softmax temperature, in range [0, inf].</span>
<span class="sd">            Note that this is temperature rather than inverse temperature;</span>
<span class="sd">            values are divided by this value. Higher values make choices less</span>
<span class="sd">            deterministic. Defaults to 1.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ArrayLike: Choice probabilities, of shape (n_trials, n_bandits)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.softmax_stickiness" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">softmax_stickiness</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">softmax_stickiness</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.softmax_stickiness(value)">value</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.softmax_stickiness(temperature)">temperature</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.softmax_stickiness(stickiness)">stickiness</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.softmax_stickiness(prev_choice)">prev_choice</a></span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-external" title="typing.Optional" href="https://docs.python.org/3/library/typing.html#typing.Optional">Optional</a></span><span class="p">[</span><span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Softmax function with choice stickiness, and optional temperature
parameter.</p>
<p>The standard softmax function is:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{Q(a) / \tau}}{\sum_{b} e^{Q(b) / \tau}}
\]</div>
<p>With stickiness added:</p>
<div class="arithmatex">\[
P(a) = \frac{e^{(Q(a) + \kappa \cdot same(a, a_{t-1}))/\tau}}
{\sum_{b} e^{(Q(b) + \kappa \cdot same(b, a_{t-1}))/\tau}}
\]</div>
<ul>
<li><span class="arithmatex">\(P(a)\)</span> is the probability of choosing action <span class="arithmatex">\(a\)</span></li>
<li><span class="arithmatex">\(Q(a)\)</span> is the value of action <span class="arithmatex">\(a\)</span></li>
<li><span class="arithmatex">\(\beta\)</span> is the temperature parameter</li>
<li><span class="arithmatex">\(\kappa\)</span> is the stickiness parameter</li>
<li><span class="arithmatex">\(same(a, a_{t-1})\)</span> is 1 if <span class="arithmatex">\(a\)</span> matches the previous choice, 0 otherwise</li>
</ul>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.softmax_stickiness(value)" class="doc doc-heading doc-heading-parameter">              <b><code>value</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Array of values to apply softmax to, shape
<code>(n_trials, n_bandits)</code>. 
Note that this <strong>does not</strong>
account for trial-wise dependencies, so each trial is treated
independently (i.e., we use precomputed choices, therefore the 
precomputed choice on trial <code>t-1</code> can influence the choice on 
trial <code>t</code>, but this altered choice likelihood on trial <code>t</code> will not
affect any subsequent trials since we rely on the precomputed
choices provided).
This can be useful to apply the same stickiness to
all trials, but additional code will be required to account for
trial-wise dependencies (i.e., the choice on trial <code>t-1</code>)
influencing the choice on trial <code>t</code>, and this subsequently
influencing trials <code>t+1</code> etc.).</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.softmax_stickiness(temperature)" class="doc doc-heading doc-heading-parameter">              <b><code>temperature</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>1.0</code>
)
          –
          <div class="doc-md-description">
            <p>Softmax temperature, in range [0, inf].
Note that this is temperature rather than inverse temperature;
values are divided by this value. Higher values
make choices less deterministic. Defaults to 1.0.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.softmax_stickiness(stickiness)" class="doc doc-heading doc-heading-parameter">              <b><code>stickiness</code></b>
</h4>              (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                  <code>0.0</code>
)
          –
          <div class="doc-md-description">
            <p>Weight given to previous choices, range
(-inf, inf). Positive values increase probability of repeating
choices. Defaults to 0.0</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.softmax_stickiness(prev_choice)" class="doc doc-heading doc-heading-parameter">              <b><code>prev_choice</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>, default:
                  <code>None</code>
)
          –
          <div class="doc-md-description">
            <p>One-hot encoded previous choices,
shape (n_trials, n_bandits). Defaults to None.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<b><code>ArrayLike</code></b> (              <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
)          –
          <div class="doc-md-description">
            <p>Choice probabilities, shape (n_trials, n_bandits)</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/decision_rules.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">softmax_stickiness</span><span class="p">(</span>
    <span class="n">value</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="n">stickiness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">prev_choice</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Softmax function with choice stickiness, and optional temperature</span>
<span class="sd">    parameter.</span>

<span class="sd">    The standard softmax function is:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{Q(a) / \\tau}}{\\sum_{b} e^{Q(b) / \\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    With stickiness added:</span>

<span class="sd">    $$</span>
<span class="sd">    P(a) = \\frac{e^{(Q(a) + \\kappa \\cdot same(a, a_{t-1}))/\\tau}}</span>
<span class="sd">    {\\sum_{b} e^{(Q(b) + \\kappa \\cdot same(b, a_{t-1}))/\\tau}}</span>
<span class="sd">    $$</span>

<span class="sd">    - $P(a)$ is the probability of choosing action $a$</span>
<span class="sd">    - $Q(a)$ is the value of action $a$</span>
<span class="sd">    - $\\beta$ is the temperature parameter</span>
<span class="sd">    - $\kappa$ is the stickiness parameter</span>
<span class="sd">    - $same(a, a_{t-1})$ is 1 if $a$ matches the previous choice, 0 otherwise</span>

<span class="sd">    Args:</span>
<span class="sd">        value (ArrayLike): Array of values to apply softmax to, shape</span>
<span class="sd">            `(n_trials, n_bandits)`. </span>
<span class="sd">            Note that this **does not**</span>
<span class="sd">            account for trial-wise dependencies, so each trial is treated</span>
<span class="sd">            independently (i.e., we use precomputed choices, therefore the </span>
<span class="sd">            precomputed choice on trial `t-1` can influence the choice on </span>
<span class="sd">            trial `t`, but this altered choice likelihood on trial `t` will not</span>
<span class="sd">            affect any subsequent trials since we rely on the precomputed</span>
<span class="sd">            choices provided).</span>
<span class="sd">            This can be useful to apply the same stickiness to</span>
<span class="sd">            all trials, but additional code will be required to account for</span>
<span class="sd">            trial-wise dependencies (i.e., the choice on trial `t-1`)</span>
<span class="sd">            influencing the choice on trial `t`, and this subsequently</span>
<span class="sd">            influencing trials `t+1` etc.).</span>
<span class="sd">        temperature (float, optional): Softmax temperature, in range [0, inf].</span>
<span class="sd">            Note that this is temperature rather than inverse temperature;</span>
<span class="sd">            values are divided by this value. Higher values</span>
<span class="sd">            make choices less deterministic. Defaults to 1.0.</span>
<span class="sd">        stickiness (float, optional): Weight given to previous choices, range</span>
<span class="sd">            (-inf, inf). Positive values increase probability of repeating</span>
<span class="sd">            choices. Defaults to 0.0</span>
<span class="sd">        prev_choice (ArrayLike, optional): One-hot encoded previous choices,</span>
<span class="sd">            shape (n_trials, n_bandits). Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ArrayLike: Choice probabilities, shape (n_trials, n_bandits)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">sticky_value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">+</span> <span class="n">stickiness</span> <span class="o">*</span> <span class="n">prev_choice</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sticky_value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sticky_value</span> <span class="o">/</span> <span class="n">temperature</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="behavioural_modelling.learning.sum_betas" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">sum_betas</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">sum_betas</span><span class="p">(</span><span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.sum_betas(beta1_params)">beta1_params</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" href="#behavioural_modelling.learning.sum_betas(beta2_params)">beta2_params</a></span><span class="p">:</span> <span class="n"><span title="numpy.typing.ArrayLike">ArrayLike</span></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="jax.numpy.ndarray">ndarray</span></span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Sum two beta distributions. This uses an approximation described in the following paper:</p>
<p>Pham, T.G., Turkkan, N., 1994. Reliability of a standby system with beta-distributed component lives.
IEEE Transactions on Reliability 43, 71–75. https://doi.org/10.1109/24.285114</p>
<p>Where the first two moments of the summed distribution are calculated as follows:</p>
<div class="arithmatex">\[
\mu = \mu_1 + \mu_2
\]</div>
<div class="arithmatex">\[
\sigma^2 = \sigma_1^2 + \sigma_2^2
\]</div>
<p>We then calculate the parameters of the new beta distribution using the following equations:</p>
<div class="arithmatex">\[
\alpha = \mu \left( \frac{\mu (1 - \mu)}{\sigma^2} - 1 \right)
\]</div>
<div class="arithmatex">\[
\beta = (1 - \mu) \left( \frac{\mu (1 - \mu)}{\sigma^2} - 1 \right)
\]</div>
<p>This function assumes that the means of the two beta distributions sum to &lt;=1. If this is not the case,
the output will be invalid.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.sum_betas(beta1_params)" class="doc doc-heading doc-heading-parameter">              <b><code>beta1_params</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameters of the first beta distribution. Of shape (n_options, 2),</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
<h4 id="behavioural_modelling.learning.sum_betas(beta2_params)" class="doc doc-heading doc-heading-parameter">              <b><code>beta2_params</code></b>
</h4>              (<code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>)
          –
          <div class="doc-md-description">
            <p>Parameters of second beta distribution.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="jax.numpy.ndarray">ndarray</span></code>
          –
          <div class="doc-md-description">
            <p>jnp.ndarray: New beta distribution parameters.</p>
          </div>
        </li>
    </ul>

            <details class="quote">
              <summary>Source code in <code>behavioural_modelling/learning/beta_models.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">sum_betas</span><span class="p">(</span><span class="n">beta1_params</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">,</span> <span class="n">beta2_params</span><span class="p">:</span> <span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sum two beta distributions. This uses an approximation described in the following paper:</span>

<span class="sd">    Pham, T.G., Turkkan, N., 1994. Reliability of a standby system with beta-distributed component lives.</span>
<span class="sd">    IEEE Transactions on Reliability 43, 71–75. https://doi.org/10.1109/24.285114</span>

<span class="sd">    Where the first two moments of the summed distribution are calculated as follows:</span>

<span class="sd">    $$</span>
<span class="sd">    \\mu = \\mu_1 + \\mu_2</span>
<span class="sd">    $$</span>

<span class="sd">    $$</span>
<span class="sd">    \\sigma^2 = \\sigma_1^2 + \\sigma_2^2</span>
<span class="sd">    $$</span>

<span class="sd">    We then calculate the parameters of the new beta distribution using the following equations:</span>

<span class="sd">    $$</span>
<span class="sd">    \\alpha = \\mu \\left( \\frac{\\mu (1 - \\mu)}{\\sigma^2} - 1 \\right)</span>
<span class="sd">    $$</span>

<span class="sd">    $$</span>
<span class="sd">    \\beta = (1 - \\mu) \\left( \\frac{\\mu (1 - \\mu)}{\\sigma^2} - 1 \\right)</span>
<span class="sd">    $$</span>

<span class="sd">    This function assumes that the means of the two beta distributions sum to &lt;=1. If this is not the case,</span>
<span class="sd">    the output will be invalid.</span>

<span class="sd">    Args:</span>
<span class="sd">        beta1_params (ArrayLike): Parameters of the first beta distribution. Of shape (n_options, 2),</span>
<span class="sd">        where the first dimension represents the number of options (each of which has its own</span>
<span class="sd">        beta distribution), and the sec</span>
<span class="sd">        beta2_params (ArrayLike): Parameters of second beta distribution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        jnp.ndarray: New beta distribution parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Extract parameters</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">beta1_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">beta1_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">beta2_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="n">beta2_params</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Calculate means and variances</span>
    <span class="n">mean1</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">/</span> <span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">b1</span><span class="p">)</span>
    <span class="n">var1</span> <span class="o">=</span> <span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">b1</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="n">b1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">b1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">mean2</span> <span class="o">=</span> <span class="n">a2</span> <span class="o">/</span> <span class="p">(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span>
    <span class="n">var2</span> <span class="o">=</span> <span class="p">(</span><span class="n">a2</span> <span class="o">*</span> <span class="n">b2</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">a2</span> <span class="o">+</span> <span class="n">b2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">a2</span> <span class="o">+</span> <span class="n">b2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># Sum means and variances</span>
    <span class="n">mean_new</span> <span class="o">=</span> <span class="n">mean1</span> <span class="o">+</span> <span class="n">mean2</span>
    <span class="n">var_new</span> <span class="o">=</span> <span class="n">var1</span> <span class="o">+</span> <span class="n">var2</span>

    <span class="c1"># Calculate new parameters</span>
    <span class="n">a_new</span> <span class="o">=</span> <span class="n">mean_new</span> <span class="o">*</span> <span class="p">((</span><span class="n">mean_new</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mean_new</span><span class="p">))</span> <span class="o">/</span> <span class="n">var_new</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">b_new</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mean_new</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="n">mean_new</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mean_new</span><span class="p">))</span> <span class="o">/</span> <span class="n">var_new</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Return new parameters</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">a_new</span><span class="p">,</span> <span class="n">b_new</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>